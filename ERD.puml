@startuml "HypercertERD"
title "Hypercert ERD"

' Configuration variables
!ifndef SHOW_FIELDS
!define SHOW_FIELDS false
!endif

!if (SHOW_FIELDS == "false")
hide empty fields
!endif
hide empty methods
hide stereotypes

!define REVIEW_COLOR #FFFACD
!define ARROW_COLOR #666666

<style>
document {
    title {
        FontSize 24
        FontStyle bold
    }
}
classDiagram {
    arrow {
        LineColor ARROW_COLOR
        FontColor ARROW_COLOR
        FontSize 10
    }
    .largeBold {
        header {
            FontSize 20
            FontStyle bold
        }
    }
}
</style>

' Contributors are represented by DIDs or human-readable strings
' therefore do not require modelling via a lexicon.
entity contributor #FFD4A3 {
    !if (SHOW_FIELDS == "true")
    DID or name/pseudonym
    !endif
}

' org.hypercerts.claim.activity - this is the main record
' representing a hypercert.
dataclass activity <<largeBold>> #B4E5D0 {
    !if (SHOW_FIELDS == "true")
    title
    shortDescription
    description?
    image?
    workScope?
    startDate
    endDate
    contributions[]?
    location?
    rights?
    createdAt
    !endif
}

' org.hypercerts.claim.evidence
dataclass evidence {
    !if (SHOW_FIELDS == "true")
    activity?
    content
    title
    shortDescription?
    description?
    createdAt
    !endif
}

' org.hypercerts.claim.measurement
dataclass measurement {
    !if (SHOW_FIELDS == "true")
    activity?
    measurers[]
    metric
    value
    measurementMethodType?
    measurementMethodURI?
    evidenceURI[]?
    location?
    createdAt
    !endif
}

' org.hypercerts.claim.evaluation
dataclass evaluation {
    !if (SHOW_FIELDS == "true")
    subject
    summary
    evaluators[]
    evidence[]?
    location?
    measurements[]?
    createdAt
    !endif
}

' org.hypercerts.claim.contribution
dataclass contribution {
    !if (SHOW_FIELDS == "true")
    role?
    contributors[]
    description?
    startDate
    endDate
    createdAt
    !endif
}

' app.certified.location
dataclass location {
    !if (SHOW_FIELDS == "true")
    lpVersion
    srs
    locationType
    location
    name?
    description?
    createdAt
    !endif
}

' org.hypercerts.claim.rights
dataclass rights {
    !if (SHOW_FIELDS == "true")
    rightsName
    rightsType
    rightsDescription
    attachment?
    createdAt
    !endif
}

' org.hypercerts.claim.collection
dataclass collection {
    !if (SHOW_FIELDS == "true")
    title
    shortDescription?
    coverPhoto?
    claims[]
    createdAt
    !endif
}

' NOTE: this is NOT a lexicon, but instead reflects an onchain
' tokenization of an activity record.  So it does not need
' a lexicon definition.
protocol token <<largeBold>> #FFB6C1 {
    !if (SHOW_FIELDS == "true")
    (on-chain only)
    !endif
}

activity::contributions -l-> contribution
activity::rights --> rights
activity::location --> location
evidence::activity --> activity
measurement::activity --> activity
measurement::location --> location
evaluation::evidence --> evidence
evaluation::measurements --> measurement
evaluation::subject --> activity
evaluation::location --> location
collection::claims -d-> activity
token -l-> activity : tokenizes
contribution::contributors --> contributor : made by
contributor -r-> rights : has

@enduml
